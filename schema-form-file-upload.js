angular.module("schemaForm").run(["$templateCache", function($templateCache) {$templateCache.put("directives/decorators/bootstrap/upload/file_upload.html","<div class=\"form-group\" ng-class=\"{\'has-error\': hasError(), \'has-success\': hasSuccess()}\">\n  <label class=\"control-label\" ng-show=\"showTitle()\">{{form.title}}</label>\n  <div class=\"form-group\">\n    <div class=\"gallery-box\">\n\n        <h2 class=\"blue\">Edit mode</h2>\n        <ul class=\"list-inline\">\n          <li ng-repeat=\"attachment in $$value$$.attachments\" style=\"display:inline-table;\">\n            <div class=\"text-center col-xs-12 thumb-container\" >\n              <!-- <img width=\"100\" ng-if=\"{png:1,gif:1,jpg:1,jpeg:1}[is_uploading.getExtension()]\" flow-img=\"is_uploading\" /> -->\n              <img ng-if=\"attachment.mimeType.indexOf(\'image\') != -1\" width=\"100\" ng-src=\"{{attachment.url}}\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'spreadsheetml\') != -1 || attachment.mimeType.indexOf(\'excel\') != -1\" width=\"100\" ng-src=\"images/xlsx-placeholder.png\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'wordprocessingml\') != -1 || attachment.mimeType.indexOf(\'msword\') != -1\" width=\"100\" ng-src=\"images/docx-placeholder.png\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'pdf\') != -1\" width=\"100\" ng-src=\"images/pdf-placeholder.png\" />\n              <!-- anything else - use the file placeholder -->\n              <img ng-if=\"attachment.mimeType.indexOf(\'pdf\') == -1 && attachment.mimeType.indexOf(\'image\') == -1 && attachment.mimeType.indexOf(\'spreadsheetml\') == -1 && attachment.mimeType.indexOf(\'excel\') == -1 && attachment.mimeType.indexOf(\'wordprocessingml\') == -1 && attachment.mimeType.indexOf(\'msword\') == -1\" width=\"100\" ng-src=\"images/file-placeholder.png\" />\n              <span ng-click=\"evalExpr(form.uploadOptions.modal.flow.removeFile, {formkey:form.key, index:$index, url:attachment.url});\" style=\"position:absolute; top: -10px; right: 0; z-index:1000; cursor:pointer;\">\n                <img ng-src=\"images/thumb-close.png\" />\n              </span>\n              <div class=\"thumb-overlay\">\n                <p>\n                  <span style=\"font-size: 0.8em; word-wrap: break-word;\">{{attachment.printName}}</span>\n                  \n                </p>\n              </div>\n              \n            </div>\n              \n              \n            \n          </li>\n          <li style=\"display:inline-table;\">\n            <div flow-init=\"form.uploadOptions.modal.flow.init\" flow-files-submitted=\"$flow.upload()\"\n             flow-file-added=\"!form.uploadOptions.modal.flow.imageOnly || !!{png:1,gif:1,jpg:1,jpeg:1}[$file.getExtension()]\"\n             flow-drop flow-drop-enabled=\"!form.uploadOptions.modal.flow.dropEnabled\" \n             flow-drag-enter=\"!!form.uploadOptions.modal.flow.dropEnabled ? flowClass=\'flow-drag-enter\' : flowClass={}\" flow-drag-leave=\"flowClass={}\" ng-class=\"flowClass\"\n             flow-file-success=\"evalExpr(form.uploadOptions.modal.flow.success, {file:$file, formkey:form.key})\"\n             >\n               \n                \n                  <div class=\"text-center col-xs-12 thumb-container\">\n                    \n                    <div class=\"\" flow-btn=\"\" style=\"cursor:pointer;\"><img width=\"100\" ng-src=\"images/add-placeholder.png\" /><input type=\"file\" multiple=\"multiple\" style=\"visibility: hidden; position: absolute;\">\n                        <div class=\"thumb-overlay\" style=\"width:100px;\">\n                                    <img width=\"100\" ng-src=\"images/add-placeholder-hover.png\" style=\"cursor:pointer;\"/>\n                                  </div>\n                    </div>\n                    \n                  </div>\n                  \n              \n            </div>\n          </li>\n        </ul>\n            \n            \n            \n            <!-- <div id=\"files_uploaded\" ng-show=\"$$value$$ != \'\'\" class=\"alert-success\">\n              <h2>Previously uploaded</h2>\n              <span ng-repeat=\"attachment in $$value$$.attachments\">{{attachment.printName}}</span>\n            </div> -->\n\n            <!-- <div ng-repeat=\"is_uploading in $flow.files\" ng-class=\"evalExpr(\'youAreInModal\') == true ? \'col-xs-4\' : \'col-xs-6 col-sm-3 col-md-2 col-lg-1\'\">\n              <div class=\"img-thumbnail text-center\" style=\"min-height:150px; width:100%;\">\n                <img width=\"100\" ng-if=\"{png:1,gif:1,jpg:1,jpeg:1}[is_uploading.getExtension()]\" flow-img=\"is_uploading\" />\n                <img width=\"100\" ng-if=\"{png:0,gif:0,jpg:0,jpeg:0}[is_uploading.getExtension()]\" ng-src=\"images/search-compounds.png\" />\n                <div style=\"bottom: 5px; position: absolute; width:110px;\"><span style=\"font-size: 0.8em; word-wrap: break-word;\">{{is_uploading.name}}</span><br><span ng-click=\"evalExpr(form.uploadOptions.modal.flow.removeFile, {formkey:form.key, index:$index, uniqueidentifier:is_uploading.uniqueIdentifier}); $flow.removeFile(is_uploading)\"><small>[remove]</small></span></div>\n                <div ng-show=\"is_uploading.isUploading()\" class=\"progress progress-striped\" ng-class=\"{active: is_uploading.isUploading()}\">\n\n                  <div class=\"progress-bar\" role=\"progressbar\"\n                       aria-valuenow=\"{{is_uploading.progress() * 100}}\"\n                       aria-valuemin=\"0\"\n                       aria-valuemax=\"100\"\n                       ng-style=\"{width: (is_uploading.progress() * 100) + \'%\'}\">\n                    <span class=\"sr-only\">{{is_uploading.progress()}}% Complete</span>\n                  </div>\n                </div>\n              </div>\n            </div> -->\n\n            <div class=\"clearfix\"><br></div>\n            <!-- <div class=\"buttons\">\n              <span class=\"btn btn-flat btn-primary\" flow-btn=\"\">Select File<input type=\"file\" multiple=\"multiple\" style=\"visibility: hidden; position: absolute;\"></span>\n              <span ng-hide=\"!form.uploadOptions.modal.flow.dropEnabled\">\n                <b>{{ \'or\' | translate }}</b>\n                {{ \'drag_drop_file\' | translate }}\n              </span>\n            </div> -->\n          \n\n\n      <input type=\"hidden\" sf-changed=\"form\" ng-model=\"$$value$$\" schema-validate=\"form\" />\n      <span class=\"help-block\">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\n    </div>\n    <div class=\"clearfix\"></div>\n  </div>\n</div>");
$templateCache.put("directives/decorators/bootstrap/upload/file_upload_view.html","<div class=\"form-group\" ng-class=\"{\'has-error\': hasError(), \'has-success\': hasSuccess()}\">\n  <label class=\"control-label\" ng-show=\"showTitle()\">{{form.title}}</label>\n  <div class=\"form-group\">\n    <div class=\"gallery-box\">\n      \n        <h2 class=\"blue\">View mode</h2>\n        <ul class=\"list-inline\">\n          <li ng-repeat=\"attachment in $$value$$.value.attachments\" style=\"display:inline-table;\">\n            <div class=\"text-center col-xs-12 thumb-container\" >\n              <!-- <img width=\"100\" ng-if=\"{png:1,gif:1,jpg:1,jpeg:1}[is_uploading.getExtension()]\" flow-img=\"is_uploading\" /> -->\n              <img ng-if=\"attachment.mimeType.indexOf(\'image\') != -1\" width=\"100\" ng-src=\"{{attachment.url}}\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'spreadsheetml\') != -1 || attachment.mimeType.indexOf(\'excel\') != -1\" width=\"100\" ng-src=\"images/xlsx-placeholder.png\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'wordprocessingml\') != -1 || attachment.mimeType.indexOf(\'msword\') != -1\" width=\"100\" ng-src=\"images/docx-placeholder.png\" />\n              <img ng-if=\"attachment.mimeType.indexOf(\'pdf\') != -1\" width=\"100\" ng-src=\"images/pdf-placeholder.png\" />\n              <!-- anything else - use the file placeholder -->\n              <img ng-if=\"attachment.mimeType.indexOf(\'pdf\') == -1 && attachment.mimeType.indexOf(\'image\') == -1 && attachment.mimeType.indexOf(\'spreadsheetml\') == -1 && attachment.mimeType.indexOf(\'excel\') == -1 && attachment.mimeType.indexOf(\'wordprocessingml\') == -1 && attachment.mimeType.indexOf(\'msword\') == -1\" width=\"100\" ng-src=\"images/file-placeholder.png\" />\n              <span ng-click=\"evalExpr(form.uploadOptions.modal.flow.removeFile, {formkey:form.key, index:$index, url:attachment.url});\" style=\"position:absolute; top: -10px; right: 0; z-index:1000; cursor:pointer;\">\n                <img ng-src=\"images/thumb-close.png\" />\n              </span>\n              <div class=\"thumb-overlay\">\n                <p>\n                  <span style=\"font-size: 0.8em; word-wrap: break-word;\">{{attachment.printName}}</span>\n                  \n                </p>\n              </div>\n              \n            </div>\n              \n          </li>\n        </ul>\n        \n           <!-- <div id=\"files_uploaded\" ng-show=\"$$value$$ != \'\'\" class=\"alert-success\">\n              <h2>Previously uploaded</h2>\n              <span ng-repeat=\"attachment in $$value$$.attachments\">{{attachment.printName}}</span>\n            </div> -->\n\n            <!-- <div ng-repeat=\"is_uploading in $flow.files\" ng-class=\"evalExpr(\'youAreInModal\') == true ? \'col-xs-4\' : \'col-xs-6 col-sm-3 col-md-2 col-lg-1\'\">\n              <div class=\"img-thumbnail text-center\" style=\"min-height:150px; width:100%;\">\n                <img width=\"100\" ng-if=\"{png:1,gif:1,jpg:1,jpeg:1}[is_uploading.getExtension()]\" flow-img=\"is_uploading\" />\n                <img width=\"100\" ng-if=\"{png:0,gif:0,jpg:0,jpeg:0}[is_uploading.getExtension()]\" ng-src=\"images/search-compounds.png\" />\n                <div style=\"bottom: 5px; position: absolute; width:110px;\"><span style=\"font-size: 0.8em; word-wrap: break-word;\">{{is_uploading.name}}</span><br><span ng-click=\"evalExpr(form.uploadOptions.modal.flow.removeFile, {formkey:form.key, index:$index, uniqueidentifier:is_uploading.uniqueIdentifier}); $flow.removeFile(is_uploading)\"><small>[remove]</small></span></div>\n                <div ng-show=\"is_uploading.isUploading()\" class=\"progress progress-striped\" ng-class=\"{active: is_uploading.isUploading()}\">\n\n                  <div class=\"progress-bar\" role=\"progressbar\"\n                       aria-valuenow=\"{{is_uploading.progress() * 100}}\"\n                       aria-valuemin=\"0\"\n                       aria-valuemax=\"100\"\n                       ng-style=\"{width: (is_uploading.progress() * 100) + \'%\'}\">\n                    <span class=\"sr-only\">{{is_uploading.progress()}}% Complete</span>\n                  </div>\n                </div>\n              </div>\n            </div> -->\n\n            <div class=\"clearfix\"><br></div>\n            <!-- <div class=\"buttons\">\n              <span class=\"btn btn-flat btn-primary\" flow-btn=\"\">Select File<input type=\"file\" multiple=\"multiple\" style=\"visibility: hidden; position: absolute;\"></span>\n              <span ng-hide=\"!form.uploadOptions.modal.flow.dropEnabled\">\n                <b>{{ \'or\' | translate }}</b>\n                {{ \'drag_drop_file\' | translate }}\n              </span>\n            </div> -->\n          \n\n\n      <input type=\"hidden\" sf-changed=\"form\" ng-model=\"$$value$$\" schema-validate=\"form\" />\n      <span class=\"help-block\">{{ (hasError() && errorMessage(schemaError())) || form.description}}</span>\n    </div>\n    <div class=\"clearfix\"></div>\n  </div>\n</div>");}]);
angular.module('schemaForm-file-upload', ['schemaForm', 'flow']).config(
['schemaFormProvider', 'schemaFormDecoratorsProvider', 'sfPathProvider',
  function(schemaFormProvider,  schemaFormDecoratorsProvider, sfPathProvider) {

    //directive for edit mode
    console.log('schemaFormProvider', schemaFormProvider)
    var file_upload = function(name, schema, options) {
      if (schema.type === 'object' && schema.format == 'file_upload') {
        var f = schemaFormProvider.stdFormObj(name, schema, options);
        console.log('form is',f)
        f.key  = options.path;
        //f.type = 'file_upload';
        if (schema.default.view_mode == 'view') {
          f.type = 'attachmentlist';
        }
        else {
          f.type = 'file_upload';
        }
        console.log('form type in directive: ', f.type);
        options.lookup[sfPathProvider.stringify(options.path)] = f;
        return f;
      }
      
    };

    /*var file_upload_view = function(name, schema, options) {
      if (schema.type === 'object' && schema.format == 'file_upload' && schema.default.view_mode == 'view') {
        console.log('this should be finding view');
        var f = schemaFormProvider.stdFormObj(name, schema, options);
        f.key  = options.path;
        f.type = 'file_upload_view';

        options.lookup[sfPathProvider.stringify(options.path)] = f;
        return f;
      }
      
    };*/

    schemaFormProvider.defaults.object.unshift(file_upload);
    //schemaFormProvider.defaults.object.unshift(file_upload_view);


  //Add to the bootstrap directive

    schemaFormDecoratorsProvider.addMapping('bootstrapDecorator', 'attachmentlist',
    'directives/decorators/bootstrap/upload/file_upload_view.html');
    schemaFormDecoratorsProvider.addMapping('bootstrapDecorator', 'file_upload',
    'directives/decorators/bootstrap/upload/file_upload.html');
    schemaFormDecoratorsProvider.createDirective('attachmentlist',
    'directives/decorators/bootstrap/upload/file_upload_view.html');
    schemaFormDecoratorsProvider.createDirective('file_upload',
    'directives/decorators/bootstrap/upload/file_upload.html');
  }]);
